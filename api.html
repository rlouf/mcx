
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MCX interface &#8212; mcx  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-mcx">
<span id="mcx-interface"></span><span id="api"></span><h1>MCX interface<a class="headerlink" href="#module-mcx" title="Permalink to this headline">¶</a></h1>
<p>This part of the documentation covers the public interface of <cite>mcx</cite>.</p>
<section id="interactions-with-the-model">
<h2>Interactions with the Model<a class="headerlink" href="#interactions-with-the-model" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mcx.seed">
<code class="sig-prename descclassname">mcx.</code><code class="sig-name descname">seed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">mcx.model.model</span></em>, <em class="sig-param"><span class="n">rng_key</span><span class="p">:</span> <span class="n">jax._src.numpy.lax_numpy.ndarray</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mcx.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap the model’s calling function to do the rng splitting automatically.</p>
</dd></dl>

<dl class="py class">
<dt id="mcx.model">
<em class="property">class </em><code class="sig-prename descclassname">mcx.</code><code class="sig-name descname">model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_fn</span><span class="p">:</span> <span class="n">function</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mcx.model" title="Permalink to this definition">¶</a></dt>
<dd><p>MCX representation of a probabilistic model (or program).</p>
<p>Models are expressed as generative functions. The expression of the model
within the function should be as close to the mathematical expression as
possible. The only difference with standard python code is the use of the
“&lt;~” operator for random variable assignments. Model definitions are python
functions decorated with the <cite>&#64;mcx.model</cite> decorator. Calling the model returns
samples from the prior predictive distribution.</p>
<p>A model is a representation of a probabilistic graphical model, and as such
implicitly defines a multivariate probability distribution. The class
<cite>model</cite> thus inherits from the <cite>Distribution</cite> class and implements the
<cite>logpdf</cite> and <cite>sample</cite> method. The <cite>sample</cite> method returns samples from the
joint probability distribution.</p>
<p>Since it represents a probability graphical model, the <cite>model</cite> instance is
a (multivariate) probability distribution, and as such inherits from the
<cite>Distribution</cite> class. It implements the <cite>sample</cite> and <cite>logpdf</cite> methods.</p>
<p>Model expressions are parsed into an internal graph representation that can
be conditioned on data, compiled into a logpdf or a forward sampler. The
result is pure functions that can be further JIT-compiled with JAX,
differentiated and dispatched on GPUs and TPUs. The graph can be inspected
and modified at runtime.</p>
<dl class="py attribute">
<dt id="mcx.model.model_fn">
<code class="sig-name descname">model_fn</code><a class="headerlink" href="#mcx.model.model_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that contains <cite>mcx</cite> model definition.</p>
</dd></dl>

<dl class="py attribute">
<dt id="mcx.model.graph">
<code class="sig-name descname">graph</code><a class="headerlink" href="#mcx.model.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>The internal representation of the model as a graphical model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="mcx.model.namespace">
<code class="sig-name descname">namespace</code><a class="headerlink" href="#mcx.model.namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>The namespace in which the function is called.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">__call__:</code></dt>
<dd><p>Return a sample from the prior predictive distribution.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">sample:</code></dt>
<dd><p>Return a sampler from the joint probability distribution.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">logpdf:</code></dt>
<dd><p>Return the value of the log-probability density function of the
implied multivariate probability distribution.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">seed:</code></dt>
<dd><p>Seed the model with an auto-updating PRNGKey so the sampling methods do
not need to be called with a new key each time.</p>
</dd></dl>

<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id1"><span class="brackets">1</span></dt>
<dd><p>van de Meent, Jan-Willem, Brooks Paige, Hongseok Yang, and Frank
Wood. “An introduction to probabilistic programming.” arXiv preprint
arXiv:1809.10756 (2018).</p>
</dd>
<dt class="label" id="id2"><span class="brackets">2</span></dt>
<dd><p>Kochurov, Max, Colin Carroll, Thomas Wiecki, and Junpeng Lao.
“PyMC4: Exploiting Coroutines for Implementing a Probabilistic Programming
Framework.” (2019).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="forward-sampling">
<h2>Forward sampling<a class="headerlink" href="#forward-sampling" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">mcx</a></h1>



<p class="blurb">MCX (pronounced /miks'/) is a python probabilistic programming library based on source code transformation.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=rlouf&repo=mcx&type=star&count=False&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_model.html">Build models in MCX</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Rémi Louf.
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/rlouf/mcx" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>